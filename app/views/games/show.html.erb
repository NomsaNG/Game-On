<div class="game-show-text-white">
  <%= link_to "Go back", root_path, class: "game-show-back-link" %>

  <div class="game-show-container">
    <div class="game-show-page-container">
      <div class="game-show-details">
        <% game = Game.find(params[:id]) %>
        <div>
          <h1 class="game-show-header mb-2"><%= game.sport %> - <%= game.name %></h1>
        </div>
        <div class="btn-container">
          <% if current_user.participations.exists?(game_id: game.id, is_creator: true) %>
            <%= link_to "Edit", edit_game_path(@game), class: "btn-edit" %>
            <%= link_to "Delete",
              game_path(@game),
              data: {turbo_method: :delete, turbo_confirm: "Are you sure?"}, class: "btn-delete" %>
          <% end %>
        </div>
        <div class="game-show-body">
          <%= cl_image_tag(game.venue.photo.key, alt: "#{game.sport} court", class: "game-show-image") %>

          <div class="game-show-info">
            <h2>Description:</h2>
            <p><%= game.description %></p>

            <h2>Date and Time:</h2>

            <p><%=game.game_date %> - <%= game.start_time %> : 00</p>

            <h2>Location:</h2>
            <p><%= game.venue.name %><br><%= game.venue.address %></p>

            <h2>Spots left:</h2>
            <p><%= game.capacity %> spots remaining</p>

            <% if game.capacity > 0 %>
              <%= simple_form_for(@participation, data: { turbo: true }) do |f| %>
                <div class="d-none">
                  <%= f.input :game_id, label: false, selected: game.id%>
                  <%= f.input :user_id, label: false, selected: current_user.id%>
                </div>
                <%= f.submit "Join game", class: "create-submit-button mb-4" %>
              <% end %>
            <% else %>
              <button class="game-show-join-button" disabled>Game filled</button>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<p id="hidden-id" class="d-none"><%= @chatroom_id.to_s %></p>


<div class="container" style="width:650px">
  <!-- ... [your existing HTML/ERB content] ... -->

  <!-- Include SweetAlert Library -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- SweetAlert Trigger Script -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const form = document.querySelector('form'); // Adjust the selector if needed
      console.log("hello")
      const id = document.getElementById('hidden-id').innerText;
        console.log(id)

      form.addEventListener('submit', function (e) {
        e.preventDefault();

        // Form processing logic goes here

        // SweetAlert
        Swal.fire({
          title: 'Success!',
          text: 'Game has been joined successfully!',
          icon: 'success',
          confirmButtonText: 'Go to game chat'
        }).then((result) => {
          if (result.isConfirmed) {

            window.location.href = `/chatrooms/${id}`
          }
        });
      });
    });
  </script>
</div>
