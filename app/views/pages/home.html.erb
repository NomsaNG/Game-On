<div class="container">
  <div class="page-container">
    <div class="search-filters">
      <div class="filter-buttons">
        <button onclick="filterBy('all')">All</button>
        <button onclick="filterBy('nearMe')">Near Me</button>
        <button onclick="filterBy('playersYouKnow')">Players You Know</button>
        <button onclick="filterBy('tennis')">Tennis</button>
        <button onclick="filterBy('squash')">Squash</button>
        <button onclick="filterBy('padel')">Padel</button>
      </div>

      <div class="search-bar my-3">
        <%= form_with url: root_path, method: :get, class: "d-flex" do %>
          <%= text_field_tag :query,
                params[:query],
                class: "form-control",
                placeholder: "Type a keyword"
            %>
          <%= submit_tag "Search", name: "", class: "searchbar-button btn-primary" %>
        <% end %>
      </div>
    </div>

    <div class="all-the-games">
      <div class="load-more-games">
        <%= link_to "Load More Games", "#", class: "load-button", remote: true, id: "load-more-games", data: { action: "click->games#loadMore" }  %>
      </div>

      <!-- today's games -->
      <h1 class="m-2">Today's Games</h1>
      <div class="grid-container">
        <% today_games = @games.select { |game| game.game_date == Date.today } %>

        <% today_games.first(4).each do |game| %>
          <!-- your game card HTML here -->
        <% end %>
      </div>

      <!-- Tomorrow's games -->
      <h1 class="m-2">Tomorrow's Games</h1>
      <div class="grid-container">
        <% tomorrow_games = @games.select { |game| game.game_date == Date.tomorrow } %>

        <% tomorrow_games.first(4).each do |game| %>
          <!-- your game card HTML here -->
        <% end %>
      </div>
    </div>
  </div>
</div>

<!--  for search bar -->
<script>
  function filterBy(category) {
    // Remove 'active' class from all buttons
    const buttons = document.querySelectorAll('.filter-buttons button');
    buttons.forEach(button => {
      button.classList.remove('active');
    });

    // Add 'active' class to the clicked button
    const activeButton = document.querySelector(`[onclick="filterBy('${category}')"]`);
    activeButton.classList.add('active');

    // Get all game elements
    const games = document.querySelectorAll('.home-card-game');

    // Show all games if 'All' is selected
    if (category === 'all') {
      games.forEach(game => {
        game.style.display = 'block';
      });
      return;
    }

    // Hide games that do not match the selected category
    games.forEach(game => {
      const gameCategory = game.getAttribute('data-category');
      if (gameCategory === category) {
        game.style.display = 'block';
      } else {
        game.style.display = 'none';
      }
    });
  }
</script>

<script>
  $("#grid-container").html("<%= escape_javascript(render @games) %>");
  $("#load-more-games").hide();
</script>
